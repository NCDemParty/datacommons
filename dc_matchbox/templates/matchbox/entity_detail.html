{% extends "matchbox/base.html" %}
{% load contribution_tags %}

{% block content %}

    <h2>{{ entity.name }}</h2>
    
    {% if entity.aliases %}
        <ul id="aliases">
            {% for alias in entity.aliases.all %}
                <li><a href="http://google.com/search?q={{ alias|urlencode }}">{{ alias }}</a></li>
            {% endfor %}
        </ul>
    {% endif %}
    
    <div class="clear"></div>
    
    {% if entity.attributes %}
    	{% regroup entity.attributes.all by namespace as namespace_list %}
    	{% for namespace in namespace_list %}
            {% ifequal namespace.grouper "urn:crp:candidate" %}
                <h4>CRP Candidate IDs</h4>
                <ul>
                    {% for attr in namespace.list %}
                        <li><a href="http://www.opensecrets.org/politicians/summary.php?cid={{ attr.value }}">{{ attr.value }}</a></li>
                    {% endfor %}
                </ul>
            {% else %}
                {% ifequal namespace.grouper "urn:crp:committee" %}
                    <h4>CRP PAC</h4>
                    <ul>
                        {% for attr in namespace.list %}
                            <li><a href="http://www.opensecrets.org/pacs/lookup2.php?strID={{ attr.value }}">{{ attr.value }}</a></li>
                        {% endfor %}
                    </ul>
                {% else %}
                    {% ifequal namespace.grouper "urn:crp:organization" %}
                        <h4>CRP Organization</h4>
                        <ul>
                            {% for attr in namespace.list %}
                                <li><a href="http://www.opensecrets.org/indivs/index.php?employ={{ attr.value }}">{{ attr.value }}</a></li>
                            {% endfor %}
                        </ul>
                    {% else %}
                        <h4>Other Attributes</h4>
                        <ul>
                            {% for attr in namespace.list %}
                                <li>{{ attr.value }}</li>
                            {% endfor %}
                        </ul>
                    {% endifequal %}
                {% endifequal %}
            {% endifequal %}
        {% endfor %}
    {% endif %}

	{% if transactions.Contribution %}
    	<h3>Contributions</h3>
		<p>20 preview transactions are shown ordered by dollar amount</p>
		<div class="transaction_preview">
            {% contribution_table transactions.Contribution %}
        </div>
    {% endif %}
    
{% endblock %}

{% block sidebar %}

    <h3>Notes</h3>
    <a href="#">Add a note</a>
    
    {% if entity.notes %}
        <ul>
            {% for note in entity.notes %}
                <li>{{ note }}</li>
            {% endfor %}
        </ul>
    {% endif %}
    
{% endblock %}